#!/usr/bin/env python3

from usb1 import USBContext

with USBContext() as context:
    handle = context.openByVendorIDAndProductID(0x2808, 0x93A9)

    with handle.claimInterface(0):
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x64, 0x9001, 0x0000, [])
        handle.controlWrite(0x40, 0x64, 0x9001, 0x0000, [])
        handle.controlWrite(0x40, 0x64, 0x9001, 0x0000, [])
        handle.controlWrite(0x40, 0x64, 0x9001, 0x0000, [])
        handle.controlWrite(0x40, 0x64, 0x9001, 0x0000, [])
        handle.controlWrite(0x40, 0x64, 0x0603, 0x00F9, [])
        handle.controlWrite(0x40, 0x34, 0x0002, 0x0000, [])
        handle.controlWrite(0x40, 0x35, 0x0004, 0x85C0, [])

        handle.bulkWrite(0x02, [0x11, 0xEE, 0x02, 0x00])

        handle.controlWrite(0x40, 0x03, 0x0001, 0x00A4, [])
        handle.controlWrite(0x40, 0x57, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x66, 0x00DF, 0x00C8, [])
        handle.controlWrite(0x40, 0x66, 0x001D, 0x00F1, [])
        handle.controlWrite(0x40, 0x66, 0x0001, 0x00F4, [])
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x57, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x69, 0x0055, 0x00C2, [])
        handle.controlWrite(0x40, 0x57, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x69, 0x0055, 0x00C2, [])
        handle.controlWrite(0x40, 0x57, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x69, 0x0055, 0x00C2, [])
        handle.controlWrite(0x40, 0x34, 0x00FF, 0x0000, [])
        handle.controlWrite(0x40, 0x34, 0x0002, 0x0000, [])
        handle.controlWrite(0x40, 0x35, 0x0040, 0x0000, [])

        with open("/usr/lib/firmware/ft9201.bin", "rb") as file:
            while data := file.read(64):
                handle.bulkWrite(0x02, data)

        handle.controlWrite(0x40, 0x40, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x40, 0x0000, 0x0000, [])
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x22, 0x0070, 0x0070, [])
        handle.controlWrite(0x40, 0x3B, 0x0000, 0x0022, [])
        handle.controlWrite(0x40, 0x3B, 0x000E, 0x0023, [])
        handle.controlWrite(0x40, 0x3B, 0x0001, 0x0001, [])
        handle.controlWrite(0x40, 0x3B, 0x000F, 0x0041, [])
        handle.controlWrite(0x40, 0x3B, 0x00BB, 0x0030, [])
        handle.controlWrite(0x40, 0x3B, 0x0001, 0x001F, [])
        handle.controlWrite(0x40, 0x3B, 0x0001, 0x001E, [])
